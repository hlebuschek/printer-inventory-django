# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–º–ø–æ—Ä—Ç—É –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ –Ω–æ–≤–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

## –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ú–æ–¥–µ–ª—å –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å –Ω–µ –ø–æ–¥—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–†–µ—à–µ–Ω–∏–µ:** –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ! –ú–æ–¥–µ–ª–∏ –ø—Ä–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤ –¥–≤–∞ —ç—Ç–∞–ø–∞:

1. **–ü—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ** - –ø—Ä–∏–Ω—Ç–µ—Ä—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –±–µ–∑ `device_model` (–ø–æ–ª–µ nullable)
2. **–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –æ–ø—Ä–æ—Å–∞** - SNMP –ø–æ–ª—É—á–∏—Ç —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ `model` (–Ω–∞–ø—Ä–∏–º–µ—Ä, "MP C2004")
3. **–ú–∏–≥—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π** - –∫–æ–º–∞–Ω–¥–∞ `migrate_models_to_devicemodel` –Ω–∞–π–¥–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ö–æ–ª–ª–∏–∑–∏–∏ MAC/IP –∞–¥—Ä–µ—Å–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –ë–î `ip_address` –∏ `mac_address` –∏–º–µ—é—Ç UNIQUE constraint. –ï—Å–ª–∏ —Å–ª—É—á–∞–π–Ω–æ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–Ω—Ç–µ—Ä —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º IP/MAC ‚Üí –æ—à–∏–±–∫–∞!

**–†–µ—à–µ–Ω–∏–µ:** –ö–æ–º–∞–Ω–¥–∞ `import_printers_xlsx` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–ª–ª–∏–∑–∏–∏:
- –ï—Å–ª–∏ MAC/IP —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Üí –≤—ã–¥–∞—Å—Ç –æ—à–∏–±–∫—É —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Å—Ç—Ä–æ–∫–∏
- –§–ª–∞–≥ `--skip-collisions` ‚Üí –ø—Ä–æ–ø—É—Å—Ç–∏—Ç —Ç–∞–∫–∏–µ –ø—Ä–∏–Ω—Ç–µ—Ä—ã (–ø–æ–ª–µ–∑–Ω–æ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö)

---

## Workflow –∏–º–ø–æ—Ä—Ç–∞ –Ω–æ–≤–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ Excel —Ñ–∞–π–ª–∞

–°–æ–∑–¥–∞–π—Ç–µ Excel —Ñ–∞–π–ª —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:

| IP –∞–¥—Ä–µ—Å      | –°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä | MAC –∞–¥—Ä–µ—Å          | SNMP Community | –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è | –ú–µ—Ç–æ–¥ –æ–ø—Ä–æ—Å–∞ |
|---------------|----------------|---------------------|----------------|-------------|--------------|
| 192.168.1.100 | ABC123         | AA:BB:CC:DD:EE:FF  | public         | –ù–æ–≤–∞—è –æ—Ä–≥   | SNMP         |
| 192.168.1.101 | XYZ456         |                     | public         | –ù–æ–≤–∞—è –æ—Ä–≥   | SNMP         |
| 192.168.1.102 |                | 11:22:33:44:55:66  | custom123      | –ù–æ–≤–∞—è –æ—Ä–≥   | WEB          |

**–í–∞–∂–Ω–æ:**
- **IP –∞–¥—Ä–µ—Å** - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π, –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º
- **–°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä** - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (–ø–æ–ª—É—á–∏—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–ø—Ä–æ—Å–µ)
- **MAC –∞–¥—Ä–µ—Å** - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ù–û –¥–ª—è –ø—Ä–æ—à–∏—Ç—ã—Ö –º–æ–¥–µ–ª–µ–π –ª—É—á—à–µ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º!
- **SNMP Community** - –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "public"
- **–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è** - –Ω–∞–∑–≤–∞–Ω–∏–µ (–¥–æ–ª–∂–Ω–æ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--auto-create-org`)
- **–ú–µ—Ç–æ–¥ –æ–ø—Ä–æ—Å–∞** - SNMP –∏–ª–∏ WEB (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é SNMP)

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ (dry-run)

```bash
# –ê–Ω–∞–ª–∏–∑ —Ñ–∞–π–ª–∞ –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î
python manage.py import_printers_xlsx printers.xlsx --dry-run --show-details

# –ï—Å–ª–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - —Å–æ–∑–¥–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
python manage.py import_printers_xlsx printers.xlsx --dry-run --auto-create-org

# –ï—Å–ª–∏ –µ—Å—Ç—å –∫–æ–ª–ª–∏–∑–∏–∏ MAC/IP - –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å (–¥–ª—è –ø—Ä–æ—à–∏—Ç—ã—Ö –º–æ–¥–µ–ª–µ–π)
python manage.py import_printers_xlsx printers.xlsx --dry-run --skip-collisions
```

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—ã–≤–æ–¥:**
```
=== –ò–º–ø–æ—Ä—Ç –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ –∏–∑ Excel ===
–§–∞–π–ª: printers.xlsx
–õ–∏—Å—Ç: Sheet1

–ù–∞–π–¥–µ–Ω—ã —Å—Ç–æ–ª–±—Ü—ã:
  IP –∞–¥—Ä–µ—Å: –∫–æ–ª–æ–Ω–∫–∞ 1
  –°–µ—Ä–∏–π–Ω—ã–π –Ω–æ–º–µ—Ä: –∫–æ–ª–æ–Ω–∫–∞ 2
  MAC –∞–¥—Ä–µ—Å: –∫–æ–ª–æ–Ω–∫–∞ 3
  SNMP Community: –∫–æ–ª–æ–Ω–∫–∞ 4
  –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è: –∫–æ–ª–æ–Ω–∫–∞ 5
  –ú–µ—Ç–æ–¥ –æ–ø—Ä–æ—Å–∞: –∫–æ–ª–æ–Ω–∫–∞ 6

  OK (—Å—Ç—Ä–æ–∫–∞ 2): 192.168.1.100 [–ù–æ–≤–∞—è –æ—Ä–≥] | SN:ABC123 | MAC:AA:BB:CC:DD:EE:FF | SNMP
  MAC_COLLISION (—Å—Ç—Ä–æ–∫–∞ 3): 11:22:33:44:55:66 —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (IP: 192.168.1.101)
  OK (—Å—Ç—Ä–æ–∫–∞ 4): 192.168.1.102 [–ù–æ–≤–∞—è –æ—Ä–≥] | SN:–ø—É—Å—Ç–æ | MAC:–ø—É—Å—Ç–æ | WEB

==================================================
–ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê:
  –í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: 3
  –£—Å–ø–µ—à–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ: 2
  –ö–æ–ª–ª–∏–∑–∏–∏ MAC –∞–¥—Ä–µ—Å–æ–≤: 1

‚ö†Ô∏è  –í–ù–ò–ú–ê–ù–ò–ï: –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∫–æ–ª–ª–∏–∑–∏–∏ MAC –∞–¥—Ä–µ—Å–æ–≤!
–≠—Ç–æ –º–æ–≥—É—Ç –±—ã—Ç—å –ø—Ä–æ—à–∏—Ç—ã–µ –º–æ–¥–µ–ª–∏ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤.
–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
  1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ª–∏ —ç—Ç–æ –ø—Ä–æ—à–∏—Ç—ã–µ –º–æ–¥–µ–ª–∏
  2. –ï—Å–ª–∏ –¥–∞ - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ --skip-collisions –¥–ª—è –∏—Ö –ø—Ä–æ–ø—É—Å–∫–∞
  3. –ò–ª–∏ —É–¥–∞–ª–∏—Ç–µ MAC –∞–¥—Ä–µ—Å–∞ –∏–∑ Excel –¥–ª—è —ç—Ç–∏—Ö –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤
```

### –®–∞–≥ 3: –†–µ–∞–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç

```bash
# –ò–º–ø–æ—Ä—Ç —Å –∞–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏–µ–º –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏ –ø—Ä–æ–ø—É—Å–∫–æ–º –∫–æ–ª–ª–∏–∑–∏–π
python manage.py import_printers_xlsx printers.xlsx --auto-create-org --skip-collisions
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
–°–æ—Ö—Ä–∞–Ω—è–µ–º 2 –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤...
–í—Å–µ –ø—Ä–∏–Ω—Ç–µ—Ä—ã —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!

==================================================
–ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω!

–°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–ø—Ä–æ—Å –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤:
   python manage.py run_polling

2. –ü–æ—Å–ª–µ –æ–ø—Ä–æ—Å–∞ –ø—Ä–æ—Å—Ç–∞–≤—å—Ç–µ –º–æ–¥–µ–ª–∏ –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞:
   python manage.py migrate_models_to_devicemodel --dry-run
   python manage.py migrate_models_to_devicemodel

3. –ß–µ—Ä–µ–∑ 3 –º–µ—Å—è—Ü–∞ –¥–æ–±–∞–≤—å—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ contracts –∏ —Å–≤—è–∂–∏—Ç–µ:
   python manage.py link_devices_by_serial --dry-run
```

### –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ –æ–ø—Ä–æ—Å–∞

```bash
# –û–ø—Ä–æ—Å –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ (—á–µ—Ä–µ–∑ web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–ª–∏ API)
# –ò–ª–∏ –º–∞—Å—Å–æ–≤—ã–π –æ–ø—Ä–æ—Å —á–µ—Ä–µ–∑ Celery:
celery -A printer_inventory call inventory.tasks.run_inventory_task_priority --args='[–ø—Ä–∏–Ω—Ç–µ—Ä_id]'
```

–ü–æ—Å–ª–µ –æ–ø—Ä–æ—Å–∞:
- –ë—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã —Å–µ—Ä–∏–π–Ω—ã–µ –Ω–æ–º–µ—Ä–∞
- –ë—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã MAC –∞–¥—Ä–µ—Å–∞
- –ë—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è `model` (–Ω–∞–ø—Ä–∏–º–µ—Ä, "Ricoh MP C2004")

### –®–∞–≥ 5: –ü—Ä–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞, –∫–∞–∫–∏–µ –º–æ–¥–µ–ª–∏ –±—É–¥—É—Ç –ø—Ä–æ—Å—Ç–∞–≤–ª–µ–Ω—ã
python manage.py migrate_models_to_devicemodel --dry-run

# –†–µ–∞–ª—å–Ω–æ–µ –ø—Ä–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ
python manage.py migrate_models_to_devicemodel
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ –≤ DeviceModel
--------------------------------------------------------------------------------
üìä –ù–∞–π–¥–µ–Ω–æ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏: 50

‚úÖ 192.168.1.100 | SN:ABC123
   –¢–µ–∫—Å—Ç: 'MP C2004'
   –ë—ã–ª–æ: (–ø—É—Å—Ç–æ)
   –°—Ç–∞–ª–æ: Ricoh MP C2004

‚úÖ 192.168.1.101 | SN:XYZ456
   –¢–µ–∫—Å—Ç: 'Kyocera TASKalfa 3252ci'
   –ë—ã–ª–æ: (–ø—É—Å—Ç–æ)
   –°—Ç–∞–ª–æ: Kyocera TASKalfa 3252ci

‚ö†Ô∏è  –ú–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ: 'Unknown Model' (IP: 192.168.1.102)

--------------------------------------------------------------------------------
üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–∏:
  –í—Å–µ–≥–æ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤: 50
  –ù–∞–π–¥–µ–Ω–æ –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ: 49
  –û–±–Ω–æ–≤–ª–µ–Ω–æ: 49
  –ù–µ –Ω–∞–π–¥–µ–Ω–æ –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ: 1

üí° –°–æ–≤–µ—Ç: –î–æ–±–∞–≤—å—Ç–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –º–æ–¥–µ–ª–∏ –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ contracts
–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –ø–æ–≤—Ç–æ—Ä–Ω–æ
```

### –®–∞–≥ 6 (—á–µ—Ä–µ–∑ 3 –º–µ—Å—è—Ü–∞): –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ contracts

–ö–æ–≥–¥–∞ –¥–æ–≥–æ–≤–æ—Ä –±—É–¥–µ—Ç –∑–∞–∫–ª—é—á–µ–Ω:

```bash
# 1. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ contracts (—á–µ—Ä–µ–∑ Excel –∏–ª–∏ –≤—Ä—É—á–Ω—É—é)
python manage.py contracts_import_xlsx –¥–æ–≥–æ–≤–æ—Ä.xlsx

# 2. –°–≤—è–∂–∏—Ç–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å –ø—Ä–∏–Ω—Ç–µ—Ä–∞–º–∏ –ø–æ —Å–µ—Ä–∏–π–Ω—ã–º –Ω–æ–º–µ—Ä–∞–º
python manage.py link_devices_by_serial --dry-run
python manage.py link_devices_by_serial
```

---

## FAQ

### Q: –ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å –ø—Ä–æ—à–∏—Ç—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏?

**A:** –ü—Ä–æ—à–∏—Ç—ã–µ –º–æ–¥–µ–ª–∏ –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ MAC/IP. –î–≤–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞:

1. **–ù–µ —É–∫–∞–∑—ã–≤–∞—Ç—å MAC –∞–¥—Ä–µ—Å –≤ Excel** - –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `--skip-collisions`** - –ø—Ä–æ–ø—É—Å—Ç–∏—Ç –¥—É–±–ª–∏–∫–∞—Ç—ã

### Q: –ú–æ–∂–Ω–æ –ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–Ω—Ç–µ—Ä—ã –±–µ–∑ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏?

**A:** –î–∞, –æ—Å—Ç–∞–≤—å—Ç–µ –∫–æ–ª–æ–Ω–∫—É "–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è" –ø—É—Å—Ç–æ–π. –ù–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É.

### Q: –ß—Ç–æ –µ—Å–ª–∏ –º–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ?

**A:** –î–æ–±–∞–≤—å—Ç–µ –º–æ–¥–µ–ª—å –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ `contracts.DeviceModel`:

```python
python manage.py shell

from contracts.models import Manufacturer, DeviceModel

# –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è (–µ—Å–ª–∏ –Ω–µ—Ç)
ricoh = Manufacturer.objects.get_or_create(name="Ricoh")[0]

# –°–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å
DeviceModel.objects.create(
    manufacturer=ricoh,
    name="MP C2004",
    device_type="printer",
    has_network_port=True
)
```

–ó–∞—Ç–µ–º –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ:
```bash
python manage.py migrate_models_to_devicemodel
```

### Q: –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ –∫–æ–ª–ª–∏–∑–∏–∏ –ø–µ—Ä–µ–¥ –∏–º–ø–æ—Ä—Ç–æ–º?

**A:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--dry-run`:

```bash
python manage.py import_printers_xlsx printers.xlsx --dry-run --show-details
```

–ö–æ–º–∞–Ω–¥–∞ –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ –∫–æ–ª–ª–∏–∑–∏–∏ –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ –ë–î.

### Q: –ú–æ–∂–Ω–æ –ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ IP –∞–¥—Ä–µ—Å–∞?

**A:** –î–∞! –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π Excel:

| IP –∞–¥—Ä–µ—Å      |
|---------------|
| 192.168.1.100 |
| 192.168.1.101 |

–û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω—è—Ç—Å—è –ø—Ä–∏ –æ–ø—Ä–æ—Å–µ –∏–ª–∏ –æ—Å—Ç–∞–Ω—É—Ç—Å—è –ø—É—Å—Ç—ã–º–∏.

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### –ß–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É Django

1. –û—Ç–∫—Ä–æ–π—Ç–µ `/admin/inventory/printer/`
2. –§–∏–ª—å—Ç—Ä –ø–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –ø—Ä–∏–Ω—Ç–µ—Ä—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã

### –ß–µ—Ä–µ–∑ shell

```bash
python manage.py shell
```

```python
from inventory.models import Printer, Organization

# –ü–æ—Å—á–∏—Ç–∞—Ç—å –ø—Ä–∏–Ω—Ç–µ—Ä—ã –Ω–æ–≤–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
org = Organization.objects.get(name="–ù–æ–≤–∞—è –æ—Ä–≥")
printers = Printer.objects.filter(organization=org)
print(f"–í—Å–µ–≥–æ –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤: {printers.count()}")

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —É —Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ—Å—Ç–∞–≤–ª–µ–Ω–∞ –º–æ–¥–µ–ª—å
with_model = printers.filter(device_model__isnull=False).count()
print(f"–° –º–æ–¥–µ–ª—å—é –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞: {with_model}")

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —É —Å–∫–æ–ª—å–∫–∏—Ö –µ—Å—Ç—å —Å–µ—Ä–∏–π–Ω–∏–∫
with_sn = printers.exclude(serial_number="").count()
print(f"–° —Å–µ—Ä–∏–π–Ω—ã–º –Ω–æ–º–µ—Ä–æ–º: {with_sn}")
```

---

## –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∫–æ–º–∞–Ω–¥

```bash
# 1. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ Excel —Ñ–∞–π–ª printers.xlsx

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–∞
python manage.py import_printers_xlsx printers.xlsx --dry-run --show-details --auto-create-org

# 3. –†–µ–∞–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç
python manage.py import_printers_xlsx printers.xlsx --auto-create-org --skip-collisions

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–ø—Ä–æ—Å (—á–µ—Ä–µ–∑ web UI –∏–ª–∏ API)

# 5. –ü—Ä–æ—Å—Ç–∞–≤—å—Ç–µ –º–æ–¥–µ–ª–∏
python manage.py migrate_models_to_devicemodel --dry-run
python manage.py migrate_models_to_devicemodel

# 6. –ü—Ä–æ–≤–µ—Ä–∫–∞
python manage.py shell
>>> from inventory.models import Organization
>>> org = Organization.objects.get(name="–ù–æ–≤–∞—è –æ—Ä–≥")
>>> org.printers.count()
50
>>> org.printers.filter(device_model__isnull=False).count()
49

# 7. –ß–µ—Ä–µ–∑ 3 –º–µ—Å—è—Ü–∞: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ contracts
python manage.py contracts_import_xlsx –¥–æ–≥–æ–≤–æ—Ä.xlsx
python manage.py link_devices_by_serial --dry-run
python manage.py link_devices_by_serial
```

---

## –†–µ–∑—é–º–µ

**–î–ª—è —Ä–µ—à–µ–Ω–∏—è —Ç–≤–æ–∏—Ö –ø—Ä–æ–±–ª–µ–º:**

1. **–ü—Ä–æ–±–ª–µ–º–∞ —Å –º–æ–¥–µ–ª—å—é** - –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞! –ú–æ–¥–µ–ª–∏ –ø—Ä–æ—Å—Ç–∞–≤—è—Ç—Å—è –ø–æ—Å–ª–µ –æ–ø—Ä–æ—Å–∞ —á–µ—Ä–µ–∑ `migrate_models_to_devicemodel`
2. **–ü—Ä–æ–±–ª–µ–º–∞ —Å –ø—Ä–æ—à–∏—Ç—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏** - —Ä–µ—à–µ–Ω–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫—É –∫–æ–ª–ª–∏–∑–∏–π MAC/IP –≤ –∫–æ–º–∞–Ω–¥–µ `import_printers_xlsx`

**–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π workflow:**
1. –ò–º–ø–æ—Ä—Ç –ø—Ä–∏–Ω—Ç–µ—Ä–æ–≤ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∫–æ–ª–ª–∏–∑–∏–π
2. –û–ø—Ä–æ—Å ‚Üí –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
3. –ú–∏–≥—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π ‚Üí –ø—Ä–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ FK –∫ DeviceModel
4. (—á–µ—Ä–µ–∑ 3 –º–µ—Å—è—Ü–∞) –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ contracts ‚Üí —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ —Å Printer

**–ö–æ–º–∞–Ω–¥—ã:**
- `import_printers_xlsx` - –Ω–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞
- `migrate_models_to_devicemodel` - –ø—Ä–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
- `link_devices_by_serial` - —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ contracts ‚Üî inventory
