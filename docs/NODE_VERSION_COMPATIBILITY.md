# Ð¡Ð¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚ÑŒ Ð²ÐµÑ€ÑÐ¸Ð¹ Node.js Ð´Ð»Ñ offline ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸

## ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°

ÐŸÑ€Ð¸ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ð¸ npm Ð°Ñ€Ñ…Ð¸Ð²Ð° Ð½Ð° Ð¾Ð´Ð½Ð¾Ð¹ Ð²ÐµÑ€ÑÐ¸Ð¸ Node.js (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, v24) Ð¸ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐµ Ð½Ð° Ð´Ñ€ÑƒÐ³Ð¾Ð¹ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, v18), Ð¼Ð¾Ð³ÑƒÑ‚ Ð²Ð¾Ð·Ð½Ð¸ÐºÐ½ÑƒÑ‚ÑŒ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚Ð¸.

## ÐŸÐ¾Ñ‡ÐµÐ¼Ñƒ ÑÑ‚Ð¾ Ð²Ð°Ð¶Ð½Ð¾?

**Vite Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ native Ð±Ð¸Ð½Ð°Ñ€Ð½Ð¸ÐºÐ¸:**
- `esbuild` - native Go Ð±Ð¸Ð½Ð°Ñ€Ð½Ð¸Ðº (Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ð¾-ÑÐ¿ÐµÑ†Ð¸Ñ„Ð¸Ñ‡Ð½Ñ‹Ð¹)
- `@rollup/rollup-*` - native Node.js Ð¼Ð¾Ð´ÑƒÐ»ÑŒ (Ð·Ð°Ð²Ð¸ÑÐ¸Ñ‚ Ð¾Ñ‚ Ð²ÐµÑ€ÑÐ¸Ð¸ Node)

### Ð§Ñ‚Ð¾ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¾ Ð² Ð¿Ñ€Ð¾ÐµÐºÑ‚Ðµ:

```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ°
npm list esbuild rollup

# Ð¢ÐµÐºÑƒÑ‰Ð¸Ðµ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸:
esbuild@0.21.5 (Ñ‡ÐµÑ€ÐµÐ· vite@5.4.21)
@rollup/rollup-linux-x64-gnu (native module)
```

---

## âœ… Ð ÐµÑˆÐµÐ½Ð¸Ñ

### Ð ÐµÑˆÐµÐ½Ð¸Ðµ 1: Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð¾Ð´Ð¸Ð½Ð°ÐºÐ¾Ð²ÑƒÑŽ Ð²ÐµÑ€ÑÐ¸ÑŽ Node.js (Ð Ð•ÐšÐžÐœÐ•ÐÐ”Ð£Ð•Ð¢Ð¡Ð¯)

#### ÐÐ° MacBook (ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Node.js 18):

```bash
# 1. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ nvm (ÐµÑÐ»Ð¸ ÐµÑ‰Ñ‘ Ð½ÐµÑ‚)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash
source ~/.zshrc  # Ð¸Ð»Ð¸ ~/.bash_profile

# 2. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Node.js 18 (Ñ‚Ð°ÐºÑƒÑŽ Ð¶Ðµ, ÐºÐ°Ðº Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ)
nvm install 18
nvm use 18

# 3. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð²ÐµÑ€ÑÐ¸ÑŽ
node -v  # Ð”Ð¾Ð»Ð¶Ð½Ð¾ Ð±Ñ‹Ñ‚ÑŒ v18.x.x

# 4. ÐŸÐµÑ€ÐµÑÐ¾Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
rm -rf node_modules package-lock.json
npm install

# 5. Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð°Ñ€Ñ…Ð¸Ð²
tar -czf npm-dependencies.tar.gz node_modules package.json package-lock.json
```

#### ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð¼ÐµÐ¶Ð´Ñƒ Ð²ÐµÑ€ÑÐ¸ÑÐ¼Ð¸:

```bash
# Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Node 18 Ð´Ð»Ñ ÑÑ‚Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
nvm use 18

# Ð’ÐµÑ€Ð½ÑƒÑ‚ÑŒÑÑ Ðº Node 24
nvm use 24

# ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ðµ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ (ÑÐ¾Ð·Ð´Ð°Ñ‚ÑŒ .nvmrc)
echo "18" > .nvmrc
# Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð¿Ñ€Ð¾ÑÑ‚Ð¾: nvm use
```

---

### Ð ÐµÑˆÐµÐ½Ð¸Ðµ 2: Ð¡Ð¾Ð±Ñ€Ð°Ñ‚ÑŒ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ (ÐµÑÐ»Ð¸ ÐµÑÑ‚ÑŒ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¹ Ð¸Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚)

```bash
# ÐÐ° ÑÐµÑ€Ð²ÐµÑ€Ðµ Ñ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¼ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð¾Ð¼ Ðº Ð¸Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚Ñƒ:
cd /var/www/printer-inventory

# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
npm install

# Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð°Ñ€Ñ…Ð¸Ð² Ð´Ð»Ñ Ð±ÑƒÐ´ÑƒÑ‰ÐµÐ³Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ
tar -czf npm-dependencies.tar.gz node_modules package.json package-lock.json

# Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚Ðµ Ð°Ñ€Ñ…Ð¸Ð² Ð´Ð»Ñ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ³Ð¾ Ñ€Ð°Ð·Ð°
cp npm-dependencies.tar.gz /backup/

# Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð¼Ð¾Ð¶Ð½Ð¾ Ð¾Ñ‚ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ Ð¸Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚
# Ð’ Ð±ÑƒÐ´ÑƒÑ‰ÐµÐ¼ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ñ€Ð°ÑÐ¿Ð°ÐºÐ¾Ð²Ñ‹Ð²Ð°Ð¹Ñ‚Ðµ ÑÑ‚Ð¾Ñ‚ Ð°Ñ€Ñ…Ð¸Ð²
```

---

### Ð ÐµÑˆÐµÐ½Ð¸Ðµ 3: Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Docker (ÑƒÐ½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ñ‹Ð¹ ÑÐ¿Ð¾ÑÐ¾Ð±)

Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¹ ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€ Ñ Ñ‚Ð¾Ð¹ Ð¶Ðµ Ð²ÐµÑ€ÑÐ¸ÐµÐ¹ Node.js, Ñ‡Ñ‚Ð¾ Ð¸ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ:

```bash
# ÐÐ° MacBook:

# 1. Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Dockerfile
cat > Dockerfile.npm-bundle << 'EOF'
FROM node:18-alpine

WORKDIR /app

COPY package.json package-lock.json ./

RUN npm ci --only=production

CMD ["tar", "-czf", "/output/npm-dependencies.tar.gz", "node_modules", "package.json", "package-lock.json"]
EOF

# 2. Ð¡Ð¾Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Ð² ÐºÐ¾Ð½Ñ‚ÐµÐ¹Ð½ÐµÑ€Ðµ
docker build -f Dockerfile.npm-bundle -t npm-bundler .

# 3. Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ Ð¸ ÑÐ¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð°Ñ€Ñ…Ð¸Ð²
docker run --rm -v $(pwd):/output npm-bundler

# 4. Ð“Ð¾Ñ‚Ð¾Ð²Ð¾! npm-dependencies.tar.gz ÑÐ¾Ð·Ð´Ð°Ð½ Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾Ð¹ Ð²ÐµÑ€ÑÐ¸ÐµÐ¹ Node
```

---

### Ð ÐµÑˆÐµÐ½Ð¸Ðµ 4: ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚Ð¸ (Ð¿ÐµÑ€ÐµÐ´ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼ Ð°Ñ€Ñ…Ð¸Ð²Ð°)

Ð•ÑÐ»Ð¸ Ð²Ñ‹ ÑƒÐ¶Ðµ ÑÐ¾Ð·Ð´Ð°Ð»Ð¸ Ð°Ñ€Ñ…Ð¸Ð² Ð½Ð° Node 24, Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ, Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð»Ð¸ Ð¾Ð½ Ð½Ð° Node 18:

```bash
# ÐÐ° ÑÐµÑ€Ð²ÐµÑ€Ðµ:
cd /var/www/printer-inventory
tar -xzf npm-dependencies.tar.gz

# Ð¢ÐµÑÑ‚ 1: ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸
npm list

# Ð¢ÐµÑÑ‚ 2: ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ±Ð¾Ñ€ÐºÐ¸
npm run build

# Ð•ÑÐ»Ð¸ Ð¿Ð¾ÑÐ²Ð»ÑÑŽÑ‚ÑÑ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Ñ‚Ð¸Ð¿Ð°:
# "Error: The module was compiled against a different Node.js version"
# Ð—Ð½Ð°Ñ‡Ð¸Ñ‚ Ð½ÑƒÐ¶Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð ÐµÑˆÐµÐ½Ð¸Ðµ 1, 2 Ð¸Ð»Ð¸ 3
```

---

## ðŸ” Ð”Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ° Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼

### ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° native Ð¼Ð¾Ð´ÑƒÐ»ÐµÐ¹:

```bash
# ÐÐ°Ð¹Ñ‚Ð¸ Ð²ÑÐµ native Ð±Ð¸Ð½Ð°Ñ€Ð½Ð¸ÐºÐ¸
find node_modules -name "*.node" -o -type f -executable -name "esbuild"

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ñƒ esbuild
ls -la node_modules/@esbuild/

# Ð”Ð¾Ð»Ð¶Ð½Ð¾ Ð±Ñ‹Ñ‚ÑŒ: linux-x64 (Ð´Ð»Ñ Linux ÑÐµÑ€Ð²ÐµÑ€Ð°)
# ÐÐ• Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ð±Ñ‹Ñ‚ÑŒ: darwin-x64 Ð¸Ð»Ð¸ darwin-arm64 (macOS)
```

### Ð¢Ð¸Ð¿Ð¸Ñ‡Ð½Ñ‹Ðµ Ð¾ÑˆÐ¸Ð±ÐºÐ¸ Ð¸ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ:

#### ÐžÑˆÐ¸Ð±ÐºÐ° 1: "Error: Cannot find module @esbuild/darwin-arm64"

```bash
# ÐŸÑ€Ð¸Ñ‡Ð¸Ð½Ð°: npm ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ð» Ð±Ð¸Ð½Ð°Ñ€Ð½Ð¸ÐºÐ¸ Ð´Ð»Ñ macOS Ð²Ð¼ÐµÑÑ‚Ð¾ Linux
# Ð ÐµÑˆÐµÐ½Ð¸Ðµ: Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ð ÐµÑˆÐµÐ½Ð¸Ðµ 1 (nvm) Ð¸Ð»Ð¸ 3 (Docker)
```

#### ÐžÑˆÐ¸Ð±ÐºÐ° 2: "The module was compiled against a different Node.js version"

```bash
# ÐŸÑ€Ð¸Ñ‡Ð¸Ð½Ð°: Ð Ð°Ð·Ð½Ñ‹Ðµ Ð²ÐµÑ€ÑÐ¸Ð¸ Node.js (24 vs 18)
# Ð ÐµÑˆÐµÐ½Ð¸Ðµ: ÐŸÐµÑ€ÐµÑÐ¾Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ Ð¾Ð´Ð¸Ð½Ð°ÐºÐ¾Ð²Ð¾Ð¹ Ð²ÐµÑ€ÑÐ¸ÐµÐ¹ (Ð ÐµÑˆÐµÐ½Ð¸Ðµ 1 Ð¸Ð»Ð¸ 2)
```

#### ÐžÑˆÐ¸Ð±ÐºÐ° 3: "node: /lib64/libm.so.6: version `GLIBC_2.27' not found"

```bash
# ÐŸÑ€Ð¸Ñ‡Ð¸Ð½Ð°: Ð Ð°Ð·Ð½Ñ‹Ðµ Ð²ÐµÑ€ÑÐ¸Ð¸ ÑÐ¸ÑÑ‚ÐµÐ¼Ð½Ñ‹Ñ… Ð±Ð¸Ð±Ð»Ð¸Ð¾Ñ‚ÐµÐº
# Ð ÐµÑˆÐµÐ½Ð¸Ðµ: Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Docker Ñ Ñ‚Ð¾Ð¹ Ð¶Ðµ Ð²ÐµÑ€ÑÐ¸ÐµÐ¹ ÐžÐ¡ (alpine, ubuntu, etc.)
```

---

## ðŸ“‹ Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸

### Ð”Ð»Ñ ÐµÐ´Ð¸Ð½Ð¸Ñ‡Ð½Ð¾Ð¹ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸:
âœ… **Ð ÐµÑˆÐµÐ½Ð¸Ðµ 1** (nvm) - ÑÐ°Ð¼Ð¾Ðµ Ð¿Ñ€Ð¾ÑÑ‚Ð¾Ðµ

### Ð”Ð»Ñ Ñ€ÐµÐ³ÑƒÐ»ÑÑ€Ð½Ñ‹Ñ… Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ð¹:
âœ… **Ð ÐµÑˆÐµÐ½Ð¸Ðµ 2** (ÑÐ±Ð¾Ñ€ÐºÐ° Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ Ñ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ð¼ Ð¸Ð½Ñ‚ÐµÑ€Ð½ÐµÑ‚Ð¾Ð¼)

### Ð”Ð»Ñ CI/CD:
âœ… **Ð ÐµÑˆÐµÐ½Ð¸Ðµ 3** (Docker) - ÑÐ°Ð¼Ð¾Ðµ Ð½Ð°Ð´Ñ‘Ð¶Ð½Ð¾Ðµ

---

## ðŸŽ¯ Ð‘Ñ‹ÑÑ‚Ñ€Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚Ð¸

ÐŸÐµÑ€ÐµÐ´ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸ÐµÐ¼ Ð°Ñ€Ñ…Ð¸Ð²Ð° ÑƒÐ±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ:

```bash
# 1. Ð’ÐµÑ€ÑÐ¸Ñ Node.js Ñ‚Ð°ÐºÐ°Ñ Ð¶Ðµ
# MacBook:
node -v  # v18.20.4

# Ð¡ÐµÑ€Ð²ÐµÑ€:
ssh server "node -v"  # v18.20.4 âœ…

# 2. ÐŸÐ»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ð° Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð°Ñ
npm list @esbuild/linux-x64  # Ð”Ð¾Ð»Ð¶ÐµÐ½ Ð±Ñ‹Ñ‚ÑŒ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½

# 3. ÐÐµÑ‚ Ð»Ð¸ÑˆÐ½Ð¸Ñ… Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ð¾-ÑÐ¿ÐµÑ†Ð¸Ñ„Ð¸Ñ‡Ð½Ñ‹Ñ… Ð¿Ð°ÐºÐµÑ‚Ð¾Ð²
npm list | grep @esbuild  # Ð”Ð¾Ð»Ð¶Ð½Ð¾ Ð±Ñ‹Ñ‚ÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ linux-x64
```

---

## ðŸ“¦ Ð“Ð¾Ñ‚Ð¾Ð²Ñ‹Ð¹ ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð´Ð»Ñ MacBook Ñ nvm

Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚Ðµ ÐºÐ°Ðº `build-npm-bundle-for-server.sh`:

```bash
#!/bin/bash
set -e

echo "ðŸ”§ Ð¡Ð±Ð¾Ñ€ÐºÐ° npm bundle Ð´Ð»Ñ Linux ÑÐµÑ€Ð²ÐµÑ€Ð° (Node.js 18)"

# ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°ÐµÐ¼ÑÑ Ð½Ð° Node 18
echo "ðŸ“Œ ÐŸÐµÑ€ÐµÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð½Ð° Node.js 18..."
nvm use 18 || {
  echo "âŒ Node.js 18 Ð½Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½. Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÑŽ..."
  nvm install 18
  nvm use 18
}

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð²ÐµÑ€ÑÐ¸ÑŽ
NODE_VERSION=$(node -v)
echo "âœ… Ð¢ÐµÐºÑƒÑ‰Ð°Ñ Ð²ÐµÑ€ÑÐ¸Ñ: $NODE_VERSION"

# ÐžÑ‡Ð¸Ñ‰Ð°ÐµÐ¼ ÑÑ‚Ð°Ñ€Ñ‹Ðµ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
echo "ðŸ§¹ ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° ÑÑ‚Ð°Ñ€Ñ‹Ñ… Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹..."
rm -rf node_modules package-lock.json

# Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÐ¼ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸
echo "ðŸ“¦ Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹..."
npm install

# Ð¡Ð¾Ð·Ð´Ð°Ñ‘Ð¼ Ð°Ñ€Ñ…Ð¸Ð²
echo "ðŸ—œï¸  Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð°Ñ€Ñ…Ð¸Ð²Ð°..."
tar -czf npm-dependencies.tar.gz node_modules package.json package-lock.json

SIZE=$(du -h npm-dependencies.tar.gz | cut -f1)
echo ""
echo "âœ… Ð“Ð¾Ñ‚Ð¾Ð²Ð¾!"
echo "ðŸ“„ Ð¤Ð°Ð¹Ð»: npm-dependencies.tar.gz"
echo "ðŸ“Š Ð Ð°Ð·Ð¼ÐµÑ€: $SIZE"
echo "ðŸŽ¯ Node.js Ð²ÐµÑ€ÑÐ¸Ñ: $NODE_VERSION"
echo ""
echo "ðŸ“ Ð¡ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ñ„Ð°Ð¹Ð» Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€ Ð¸ Ñ€Ð°ÑÐ¿Ð°ÐºÑƒÐ¹Ñ‚Ðµ:"
echo "   scp npm-dependencies.tar.gz server:/var/www/printer-inventory/"
echo "   ssh server 'cd /var/www/printer-inventory && tar -xzf npm-dependencies.tar.gz'"
```

---

## ðŸ†˜ Ð§Ñ‚Ð¾ Ð´ÐµÐ»Ð°Ñ‚ÑŒ, ÐµÑÐ»Ð¸ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ð²ÑÑ‘ Ñ€Ð°Ð²Ð½Ð¾ ÐµÑÑ‚ÑŒ?

1. **ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ð¿ÐµÑ€ÐµÑÐ¾Ð±Ñ€Ð°Ñ‚ÑŒ Ñ Ñ„Ð»Ð°Ð³Ð¾Ð¼ `--ignore-scripts`:**
   ```bash
   npm install --ignore-scripts
   npm rebuild
   ```

2. **Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ `npm ci` Ð²Ð¼ÐµÑÑ‚Ð¾ `npm install`:**
   ```bash
   npm ci  # Ð§Ð¸Ñ‰Ðµ ÑƒÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°ÐµÑ‚ Ð¸Ð· package-lock.json
   ```

3. **ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð»Ð¾Ð³Ð¸:**
   ```bash
   npm run build --verbose
   ```

4. **Ð’ ÐºÑ€Ð°Ð¹Ð½ÐµÐ¼ ÑÐ»ÑƒÑ‡Ð°Ðµ:** Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Docker (Ð ÐµÑˆÐµÐ½Ð¸Ðµ 3)

---

## Ð’Ñ‹Ð²Ð¾Ð´

**Ð’ÐÐ–ÐÐž:** Ð’ÑÐµÐ³Ð´Ð° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ð¾Ð´Ð¸Ð½Ð°ÐºÐ¾Ð²ÑƒÑŽ Ð¼Ð°Ð¶Ð¾Ñ€Ð½ÑƒÑŽ Ð²ÐµÑ€ÑÐ¸ÑŽ Node.js Ð½Ð° Ð¼Ð°ÑˆÐ¸Ð½Ðµ Ð´Ð»Ñ ÑÐ±Ð¾Ñ€ÐºÐ¸ Ð¸ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ!

- âœ… Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ: Node.js 18 (LTS)
- âš ï¸  Ð”Ð¾Ð¿ÑƒÑÑ‚Ð¸Ð¼Ð¾: Node.js 20 (LTS)
- âŒ ÐÐµ Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ: Ð Ð°Ð·Ð½Ñ‹Ðµ Ð¼Ð°Ð¶Ð¾Ñ€Ð½Ñ‹Ðµ Ð²ÐµÑ€ÑÐ¸Ð¸ (18 â†” 24)
